schema: '2.0'
stages:
  alignvideo@MT010_2a-10222021173333-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl align MT010_2 MT010_2a-10222021173333-0000
    deps:
    - path: MT010_2/MT010_2a-10222021173333-0000.avi
      md5: d5516b1cd45b3cb6c58cc2ed9fa0e7c8
      size: 2676413584
    outs:
    - path: MT010_2/MT010_2a-10222021173333-0000-synchronizedtimestamps.csv
      md5: c15b60cfac3cd62b936b5113372f99a6
      size: 379486
  alignvideo@MT020_2b-10082021191716-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl align MT020_2 MT020_2b-10082021191716-0000
    deps:
    - path: MT020_2/MT020_2b-10082021191716-0000.avi
      md5: a561b9da4c9f5318711180f18ae4d907
      size: 2376167628
    outs:
    - path: MT020_2/MT020_2b-10082021191716-0000-synchronizedtimestamps.csv
      md5: eb8657dd512609663b8e7c4c8effd9a2
      size: 409922
  alignvideo@MT020_2b-10082021193211-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl align MT020_2 MT020_2b-10082021193211-0000
    deps:
    - path: MT020_2/MT020_2b-10082021193211-0000.avi
      md5: e7e767d6cef1c8c18811a142495517e3
      size: 2294993252
    outs:
    - path: MT020_2/MT020_2b-10082021193211-0000-synchronizedtimestamps.csv
      md5: 83d745f9519d7599b3659174fdc2b50a
      size: 395735
  alignvideo@MT020_2a-10082021193209-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl align MT020_2 MT020_2a-10082021193209-0000
    deps:
    - path: MT020_2/MT020_2a-10082021193209-0000.avi
      md5: bf4a4f0e4874a21e41405d6f4c1d8589
      size: 3026303432
    outs:
    - path: MT020_2/MT020_2a-10082021193209-0000-synchronizedtimestamps.csv
      md5: deece6d9f9ee232137cdd4a235b2972c
      size: 396192
  alignvideo@MT020_2a-10082021191715-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl align MT020_2 MT020_2a-10082021191715-0000
    deps:
    - path: MT020_2/MT020_2a-10082021191715-0000.avi
      md5: aba99c323c89a61f1020a2b7341b1c60
      size: 3081868644
    outs:
    - path: MT020_2/MT020_2a-10082021191715-0000-synchronizedtimestamps.csv
      md5: 1916014bf414f6067fb581a1414ca5e1
      size: 409908
  cachecodec@MT020_2a-10082021191715-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl cachecodec MT020_2 MT020_2a-10082021191715-0000
    deps:
    - path: MT020_2/MT020_2a-10082021191715-0000-synchronizedtimestamps.csv
      md5: eb8657dd512609663b8e7c4c8effd9a2
      size: 409922
    - path: MT020_2/MT020_2a-10082021191715-0000.avi
      md5: aba99c323c89a61f1020a2b7341b1c60
      size: 3081868644
    outs:
    - path: MT020_2/pca/MT020_2a-10082021191715-0000-cropped-raw.dat
      md5: 9974f9bea98211aa9ed89a13ddf71b07
      size: 9549274136
  cachecodec@MT020_2a-10082021193209-0000:
    cmd: julia -t auto --project=. src/reducevideo.jl cachecodec MT020_2 MT020_2a-10082021193209-0000
    deps:
    - path: MT020_2/MT020_2a-10082021193209-0000-synchronizedtimestamps.csv
      md5: 83d745f9519d7599b3659174fdc2b50a
      size: 395735
    - path: MT020_2/MT020_2a-10082021193209-0000.avi
      md5: bf4a4f0e4874a21e41405d6f4c1d8589
      size: 3026303432
    outs:
    - path: MT020_2/pca/MT020_2a-10082021193209-0000-cropped-raw.dat
      md5: ca488acbd26649acdc01ef898af2a98b
      size: 8666568136
  pca@MT020_2:
    cmd: julia -t auto --project=. src/reducevideo.jl pca MT020_2
    deps:
    - path: MT020_2/pca/MT020_2a-10082021191715-0000-cropped-raw.dat
      md5: 9974f9bea98211aa9ed89a13ddf71b07
      size: 9549274136
    - path: MT020_2/pca/MT020_2a-10082021193209-0000-cropped-raw.dat
      md5: ca488acbd26649acdc01ef898af2a98b
      size: 8666568136
    params:
      params.yaml:
        backgroundrate: 0.3
        chunkdim: 200
        chunksize: 3000
        diffimagerate: 0.9
        maxpc: 40
    outs:
    - path: MT020_2/pca/MT020_2-pc-latent.csv
      md5: 7de83295afb25c7af6d45e9d36b0766f
      size: 10767632
    - path: MT020_2/pca/MT020_2-pc-latent.dat
      md5: 4e9f93b1b6eed3b4a2c7067dc329b380
      size: 5209245868
  exportpca@MT020_2:
    cmd:
    - cp MT020_2/pca/MT020_2-pc-latent.csv ../../data/ucla/2021-2022,gonogo/V1//MT020_2/MT020_2-movement,pca.csv
    deps:
    - path: MT020_2/pca/MT020_2-pc-latent.csv
      md5: 7de83295afb25c7af6d45e9d36b0766f
      size: 10767632
    outs:
    - path: ../../data/ucla/2021-2022,gonogo/V1//MT020_2/MT020_2-movement,pca.csv
      md5: 7de83295afb25c7af6d45e9d36b0766f
      size: 10767632
  reconstruct@MT020_2:
    cmd: julia -t auto --project=. src/reducevideo.jl reconstruct MT020_2
    deps:
    - path: MT020_2/pca/MT020_2-pc-latent.dat
      md5: 4e9f93b1b6eed3b4a2c7067dc329b380
      size: 5209245868
    - path: MT020_2/pca/MT020_2a-10082021191715-0000-cropped-raw.dat
      md5: 9974f9bea98211aa9ed89a13ddf71b07
      size: 9549274136
    - path: MT020_2/pca/MT020_2a-10082021193209-0000-cropped-raw.dat
      md5: ca488acbd26649acdc01ef898af2a98b
      size: 8666568136
    params:
      params.yaml:
        backgroundrate: 0.3
        chunkdim: 200
        chunksize: 3000
        diffimagerate: 0.9
        downsample: 5
        exportframeduration: 4800
        exportframestart: 9501
        maxpc: 40
        reconstructpc: 14
    outs:
    - path: MT020_2/pca/MT020_2-pc-reconstruction.avi
      md5: 741f7283eafb55e82cb7ee944399ccff
      size: 2576033566
  display@MT020_2:
    cmd: julia -t auto --project=. src/reducevideo.jl display MT020_2
    deps:
    - path: MT020_2/pca/MT020_2-pc-latent.dat
      md5: 4e9f93b1b6eed3b4a2c7067dc329b380
      size: 5209245868
    outs:
    - path: MT020_2/pca/MT020_2-pc-latent-long.png
      md5: 7583bd51d7e86d925935d78963f7752a
      size: 936036
    - path: MT020_2/pca/MT020_2-pc-latent-short.png
      md5: 338faa5abd6b9af667a8a322cb69cc0d
      size: 820482
  threshold@MT020_2:
    cmd:
    - julia -t auto --project=. src/reducevideo.jl threshold MT020_2
    - cp MT020_2/pca/MT020_2-pc-latent-motionenergy,threshold.csv /MT020_2/MT020_2-motionenergy,threshold.csv
    - chmod u+w /MT020_2/MT020_2-motionenergy,threshold.csv
    deps:
    - path: MT020_2/pca/MT020_2-pc-latent.dat
      md5: 4e9f93b1b6eed3b4a2c7067dc329b380
      size: 5209245868
    params:
      params.yaml:
        kernelhalfwidth: 4
        motionthresholds:
        - 0.1
        - 0.2
        - 0.3
        - 0.4
        - 0.5
        - 0.6
        - 0.7
        - 0.8
        - 0.9
        - 1.0
        - 1.1
        - 1.2
        - 1.3
        - 1.4
        - 1.5
        - 1.6
        - 1.7
        - 1.8
        - 1.9
        - 2.0
        proportiontrialmotionthresholds:
        - 0.05
        - 0.1
        - 0.2
        - 0.3
        - 0.5
    outs:
    - path: MT020_2/pca/MT020_2-motionenergy,threshold-view.avi
      md5: 0f4b26e9ff5b54309d7e5daf51003356
      size: 652198576
    - path: MT020_2/pca/MT020_2-pc-latent-motionenergy,threshold.csv
      md5: 7c107b0b2cd3c2d9e13ec9973944252a
      size: 59031
    - path: MT020_2/pca/MT020_2-pc-latent-motionenergy,threshold.png
      md5: 6bede1d6466ff8b2d2799d6a3a099f3f
      size: 298271
  copytimestamps@MT020_2a-10082021193209-0000:
    cmd: cp MT020_2/MT020_2b-10082021193211-0000-synchronizedtimestamps.csv MT020_2/MT020_2a-10082021193209-0000-synchronizedtimestamps.csv
    deps:
    - path: MT020_2/MT020_2b-10082021193211-0000-synchronizedtimestamps.csv
      md5: 83d745f9519d7599b3659174fdc2b50a
      size: 395735
    outs:
    - path: MT020_2/MT020_2a-10082021193209-0000-synchronizedtimestamps.csv
      md5: 83d745f9519d7599b3659174fdc2b50a
      size: 395735
  copytimestamps@MT020_2a-10082021191715-0000:
    cmd: cp MT020_2/MT020_2b-10082021191716-0000-synchronizedtimestamps.csv MT020_2/MT020_2a-10082021191715-0000-synchronizedtimestamps.csv
    deps:
    - path: MT020_2/MT020_2b-10082021191716-0000-synchronizedtimestamps.csv
      md5: eb8657dd512609663b8e7c4c8effd9a2
      size: 409922
    outs:
    - path: MT020_2/MT020_2a-10082021191715-0000-synchronizedtimestamps.csv
      md5: eb8657dd512609663b8e7c4c8effd9a2
      size: 409922
